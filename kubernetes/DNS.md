# DNS
- 쿠버네티스에서는 클러스터 내부에서만 사용하능한 DNS를 설정해놓고 사용할 수 있다. 
- 포드간 통신을 할 때나 IP가 아닌 도메인을 설정해두고 사용할 수 있다.
- IP로 통신하도록 되어 있다면 한 곳에서 세팅해놨던 yaml 파일을 다른 곳으로 옮겨 가져가서 사용하려고 할 때 그 클러스터에서 사용하는 ip 대역이 다른 것이라면 그대로 사용할 수가 없게 된다.
- 이럴 때 설정이 도메인을 사용하도록 되어 있다면 별다른 수정없이 그대로 사용할 수가 있다.

### 클러스터 내에서 도메인 사용하기
- 쿠버네티스에서 사용하는 내부 도메인은 서비스와 포드에 대해서 사용할 수 있고 일정한 패턴을 가지고 있다.
- aname이라는 네임스페이스에 속한 bservice가 있다고 했을 때 이 서비스에 접근하는 도메인은 bservice.aname.svc.cluster.local 이다.

### dns 구조
- dns 역할을 하는 kube-dns 역시 클러스터 내에서 포드로 실행되고 있다.
- 포드 내에서 dns에 질의를 할 때 어떤 순서로 할 것인지 개별 포드마다 지정해 줄 수 있다.
- 포드의 spec에 dnsPolicy를 이용햇 ㅓ지정할 수 있다.
- 사용 가능한 옵션 4가지
  - Default : dns 설정을 포드가 실행중인 노드의 설정을 가져와서 사용한다.
  - cluster first : cluster.local 같은 미리 지정된 클러스터 내부 도메인과 일치하지 않는 경우, 클러스터 외부 DNS인 upstream dns에 질의한다.
  - cluster first with host net : 포드를 host network 옵션으로 실행할 때 반드시 사용해야 하는 옵션.
  - none : 포드가 쿠버네티스 클러스터 내부의 dns 설정을 무시하도록 하는 설정이다.
